(function(b,d){var k=function k(l){l=l||{};this.version=l.version||"1.0.0";this.rootNamespace=l.root||"framework";this.fullName=l.fullName||"framework";this.defaultBaseClass=l.defaultBaseClass||Object;this.privatePrefix=l.privatePrefix||"_";this.protectedPreix=l.privatePrefix||"_"};var j={};j.version="1.0.0 alpha";j.create=function g(m){var l=new k(m);return l};var a=k.prototype;var h=a;j.register=function(l,m){if(h[l]!==d){throw new Error("Member already registered.")}h[l]=m};b.FrameworkFactory=j;Object.create=Object.create||function(m){function l(){}l.prototype=m;return new l()};Object.getPrototypeOf=Object.getPrototypeOf||function(){if(typeof"test".__proto__==="object"){Object.getPrototypeOf=function(l){return l.__proto__}}else{Object.getPrototypeOf=function(l){return l.constructor.prototype}}};Array.prototype.indexOf=Array.prototype.indexOf||function(n,o){for(var m=(o||0),l=this.length;m<l;m+=1){if(this[m]===n){return m}}return -1};String.trim=String.trim||function(l){return l.replace(/^\s\s*/,"").replace(/\s\s*$/,"")};h.utils={equals:function(n,m){var l;if(n===m){return true}for(l in n){if(m[l]===d){return false}var p=n[l];var o=m[l];if(p!==o){return false}}for(l in m){if(n[l]===d){return false}}return true},clone:function(m,l){l=l||false;throw new Error("Not implemented error.")},loadFromJSON:function(s,p,m){m=m||{};var l=m.setFunctions||false;for(var n in p){if(p.hasOwnProperty[n]===false){continue}var r=typeof s[n];var q=p[n];switch(r){case"object":if(s[n].constructor.loadFromJSON!==d){s[n].constructor.loadFromJSON(s,n,q)}else{if(s[n] instanceof Array){s[n]=q}else{h.Utils.loadFromJSON(s[n],q)}}break;case"function":if(s[n].loadFromJSON!==d){s[n].loadFromJSON(s,n,q)}else{s[n]=q}break;default:s[n]=q}}},exportToJSON:function e(m){var l={};for(key in m){}},isFunction:function(l){return typeof l==="function"},isNumber:function(l){return typeof l==="number"},isUndefined:function(l){return typeof l==="undefined"},isString:function(l){return typeof val==="string"},isDate:function(l){return(typeof l==="object")&&(l instanceof Date===true)},simpleGuid:function(l){function m(){return(((1+Math.random())*65536)|0).toString(16).substring(1)}return(m()+m()+"-"+m()+"-"+m()+"-"+m()+"-"+m()+m()+m())},emptyFn:function(){},"undefined":d};(function(m,o,p){var l=true,n=/xyz/.test(function(){xyz})?/\bbase\b/:/.*/;m.Class=function(q,w){var u=Object.prototype.hasOwnProperty,s,x,r,y,v;v=this;w=w||v.defaultBaseClass;q=q||{};l=true;s=new w;l=false;r=function r(){if(!(this instanceof r)){throw new Error("Class used as function.")}if(l===false&&this.init!==p){this.init.apply(this,arguments)}};for(x in w){if(u.call(w,x)){r[x]=w[x]}}y=w.prototype;r.prototype=s;r.prototype.constructor=r;r.__super__=y;r.attach=function t(E){var A,z,C,D,B;for(x in E){if(!u.call(E,x)){continue}A=E[x];z=typeof A;C=A;D=false;if(z==="object"&&A.type!==p){B=m.TypeHandlers[A.type];if(B!==p){B(r,x,A);D=true}}else{if(z==="function"&&typeof y[x]==="function"&&n.test(A)){s[x]=(function(F,G){return function(){this.base=function(){y[F].apply(this,arguments)};var H=G.apply(this,arguments);delete this.base;return H}})(x,A);D=true}}if(!D){s[x]=C}r.__meta__[x]=A}};r.__meta__={};r.attach(q);return r};m.TypeHandlers={}})(h,b);(function(l,n,o){l.event=function(){return{type:"framework.event"}};var m=function(p,r,q){var s=p.prototype;s[r]=function(t){var u="_"+r;if(this[u]===o){this[u]=[]}this[u].push(t)};s[r].loadFromJSON=function(w,u,t){w[u].call(w,t)};if(s.on===o){s.on=function(y,v){var x=y.split(" ");for(var u=0,w=x.length;u<w;u++){var t=String.trim(x[u]);if(this[t]!==o){this[t](v)}}};s.trigger=function(u,w){var y=this["_"+u];if(y===o||y.length===0){return this}w=w||{};w.eventName=u;for(var x=0,t=y.length;x<t;x++){var v=y[x](this,w);if(v===false){break}}return this};s.off=function(u,w){var t=this["_"+u];var v=t.indexOf(w);if(v!==-1){t.splice(v,1)}}}};l.TypeHandlers["framework.event"]=m})(h,b);(function(m,o,p){var n=function(q,r){return{type:m.fullName+".attribute",defaultValue:q,options:r}},l=function(q,s,r){var t=q.prototype,u="_"+s;t[s]=r.defaultValue};m.attribute=n;m.attr=n;m.TypeHandlers["framework.attribute"]=l})(h,b);(function(n,p,r){var q=function q(s,t){t=t||{};return{type:n.fullName+".property",defaultValue:s,readonly:false,silent:t.silent||false,get:t.get,set:t.set}},l=function l(s){if(s.get===r||s.set===r){throw new Error("Required options missing, please check get and set functions supplied.")}return{type:n.fullName+".property",defaultValue:r,readonly:false,silent:s.silent||false,get:s.get,set:s.set}},m=function m(s,t){t=t||{};return{type:"framework.readonly",defaultValue:s,readonly:true,silent:false,get:t.get}},o=function(t,E,F){var x=t.prototype,w,s,y=F.readonly,A=F.silent||false,C=F.get,v=F.set,B="_"+E;x[B]=F.defaultValue;if(y===false&&A===false){if(x.propertyChanged===r){t.attach({propertyChanging:n.event(),propertyChanged:n.event()})}}w=C||function u(){return this[B]};if(v!==r){if(A){s=v}else{s=function(H){var G=this[E],I;if(G===H){return}I={propertyName:E,oldValue:G,newValue:H};this.trigger("propertyChanging",I);v.call(this,H);this.trigger("propertyChanged",I)}}}else{if(y===true){s=function z(){throw new Error('You are not allowed to write to readonly attribute "'+E+'".')}}else{if(A){s=function(G){this[B]=G}}else{s=function D(H){var G=this[B],I;if(G===H){return}I={propertyName:E,oldValue:G,newValue:H};this.trigger("propertyChanging",I);this[B]=H;this.trigger("propertyChanged",I)}}}}if(Object.defineProperty){Object.defineProperty(x,E,{get:w,set:s})}else{if(x.__defineGetter__!==r){x.__defineGetter__(E,w);x.__defineSetter__(E,s)}}};n.TypeHandlers["framework.property"]=o;n.TypeHandlers["framework.readonly"]=o;n.property=q;n.readonly=m})(h,b);a.collections={};var f=a.collections;f.ObservableList=a.Class({},Object);f.MapList=a.Class({length:a.readonly(0),keyName:"id",validator:d,itemBeforeAdd:a.event(),itemAdd:a.event(),itemBeforeRemove:a.event(),itemRemoved:a.event(),itemBeforeSet:a.event(),itemSet:a.event(),init:function(){this._items=[];this._keys=[];this._map={};if(arguments.length>0){this.add.apply(this,arguments)}},add:function(){var p=this._items,s=this._keys,l=this._map,r=this.keyName,t,q;if(arguments[0] instanceof Array){this.add.apply(this,arguments[0]);return}for(var m=0,n=arguments.length;m<n;m++){t=arguments[m];var o={item:t,act:true};this.trigger("itemBeforeAdd",o);if(o.act===false){continue}if(typeof t==="object"&&t[r]!==d){q=t[r];if(typeof q==="function"){q=q()}if(q!==d){if(l[q]!==d){throw new Error("Item with this key ["+q+"] already exists.")}s.push(q);l[q]=t}}this._length=p.push(t);this.trigger("itemAdd",{item:t})}return this},addList:function(){var o=arguments[0];if(o instanceof Array){this.add.apply(this,o)}var m=[];for(var n=0,l=arguments.length;n<l;n++){m.push(o[n].get(n))}this.add.apply(this,m)},get:function(l){if(typeof l==="number"){return this._items[l]}return this._map[l]},replace:function(p,o){var m,n,l;l=this.findIndexKey(p);m=l[0];n=l[1];if(m!=-1){this._items[m]=o}if(n!==d){this.map[n]=o}},findIndexKey:function(n){var l,m;if(typeof n==="number"){l=n;m=this._keys[l]}else{l=this._keys.indexOf(n);m=n}if(l<0||l>=this.length){throw new Error("Index ["+l.toString()+"] out of range.")}return[l,m]},findIndexKeyByItem:function(m){var l=this._items.indexOf(m);return findIndexKey(l)},remove:function(o){var l=this.findIndexKey(o),m=l[0],n=l[1];if(m<0){this._items.splice(m,1);this._keys.splice(m,1)}if(n!==d){delete this._map[n]}return this},findKeyOrIndex:function(l){if(typeof l==="number"){return this.keys[this.keyName]}return this._keys.indexOf(l)},clear:function(){this._items=[];this._keys=[];this._map={}},indexOf:function(l){return this._items.indexOf(l)},toArray:function(){return this._items},each:function(p,o){var m,n,l;m=this._items;if(o===d){o=this}for(n=0,l=m.length;n<l;n++){p.call(o,m[n])}return this}},Object);f.MapList.loadFromJSON=function i(p,l,n){var m=p[l];if(m instanceof f.MapList===false){throw new Error('Operation "set" not supported on this object.')}m.clear();if(n instanceof Array||n instanceof f.MapList){m.add.apply(m,n)}else{if(n.$type!==d){}m.add(n)}};f.MapList.exportToJSON=function c(q){var n=[];var m=q.toArray();for(var o=0,l=q.length;o<l;o++){var p=m[o];n.push(a.utils.toJson(p))}return n};f.ObservableMapList=a.Class({itemBeforeAdd:a.event(),itemAdded:a.event(),itemBeforeRemove:a.event(),itemRemoved:a.event(),itemBeforeSet:a.event(),itemSet:a.event(),init:function(){this._list=new f.MapList();_list.add.apply(_list,arguments)},add:function(){}},f.MapList);j.plugin=function(l){l.call(b,a)};return j})(this);