/**
 * Copyright (C) 2011 - Maniar Technologies Pvt Ltd
 * Desigined By: Mohamed Aamir Maniar
 *
 * */

(function(b,d){function a(e,g){e.collections={};var h=e.collections;h.MapList=e.Class({length:e.readonly(0),keyName:"id",validator:d,itemBeforeAdd:e.event(),itemAdd:e.event(),itemBeforeRemove:e.event(),itemRemoved:e.event(),itemBeforeSet:e.event(),itemSet:e.event(),init:function(){this._items=[];this._keys=[];this._map={};if(arguments.length>0){this.add.apply(this,arguments)}},add:function(){var n=this._items,q=this._keys,j=this._map,p=this.keyName,r,o;if(arguments[0] instanceof Array){this.add.apply(this,arguments[0]);return}for(var k=0,l=arguments.length;k<l;k++){r=arguments[k];var m={item:r,act:true};this.trigger("itemBeforeAdd",m);if(m.act===false){continue}if(typeof r==="object"&&r[p]!==d){o=r[p];if(typeof o==="function"){o=o()}if(o!==d){if(j[o]!==d){throw new Error("Item with this key ["+o+"] already exists.")}q.push(o);j[o]=r}}this._length=n.push(r);this.trigger("itemAdd",{item:r})}return this},addList:function(){var m=arguments[0];if(m instanceof Array){this.add.apply(this,m)}var k=[];for(var l=0,j=arguments.length;l<j;l++){k.push(m[l].get(l))}this.add.apply(this,k)},get:function(j){if(typeof j==="number"){return this._items[j]}return this._map[j]},replace:function(n,m){var k,l,j;j=this.findIndexKey(n);k=j[0];l=j[1];if(k!=-1){this._items[k]=m}if(l!==d){this.map[l]=m}},findIndexKey:function(l){var j,k;if(typeof l==="number"){j=l;k=this._keys[j]}else{j=this._keys.indexOf(l);k=l}if(j<0||j>=this.length){throw new Error("Index ["+j.toString()+"] out of range.")}return[j,k]},findIndexKeyByItem:function(k){var j=this._items.indexOf(k);return findIndexKey(j)},remove:function(m){var j=this.findIndexKey(m),k=j[0],l=j[1];if(k<0){this._items.splice(k,1);this._keys.splice(k,1)}if(l!==d){delete this._map[l]}return this},findKeyOrIndex:function(j){if(typeof j==="number"){return this.keys[this.keyName]}return this._keys.indexOf(j)},clear:function(){this._items=[];this._keys=[];this._map={}},indexOf:function(j){return this._items.indexOf(j)},toArray:function(){return this._items},each:function(n,m){var k,l,j;k=this._items;if(m===d){m=this}for(l=0,j=k.length;l<j;l++){n.call(m,k[l])}return this}});h.MapList.loadFromJSON=function i(m,j,l){var k=m[j];if(k instanceof h.MapList===false){throw new Error('Operation "set" not supported on this object.')}k.clear();if(l instanceof Array||l instanceof h.MapList){k.add.apply(k,l)}else{if(l.$type!==d){}k.add(l)}};h.MapList.exportToJSON=function f(o){var l=[];var k=o.toArray();for(var m=0,j=o.length;m<j;m++){var n=k[m];l.push(e.utils.toJson(n))}return l};h.ObservableMapList=e.Class({itemBeforeAdd:e.event(),itemAdded:e.event(),itemBeforeRemove:e.event(),itemRemoved:e.event(),itemBeforeSet:e.event(),itemSet:e.event(),init:function(){this._list=new h.MapList();_list.add.apply(_list,arguments)},add:function(){}},h.MapList)}a.info={name:"collections"};a.toString=function c(){return a.info.name};FrameworkFactory.plugins.register(a)})(this);
